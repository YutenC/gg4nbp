<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>header</title>

    <link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../fonts/font-awesome.min.css">
    <link rel="stylesheet" href="../css/Footer-with-social-media-icons.css">
    <link rel="stylesheet" href="../css/Profile-Edit-Form.css">

    <link rel="stylesheet" href="../css/act_finder.css">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
        integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous" />
    <link rel="stylesheet" href="../css/act_irons.css">
    <style>
        .horizontal-menu {
            display: flex;
            list-style: none;
        }

        .centered-menu {
            justify-content: center;
        }

        .horizontal-menu li {
            margin-right: 20px;
        }

        .horizontal-menu li:last-child {
            margin-right: 0;
        }
    </style>
</head>

<body>
<header>
    <nav class="navbar navbar-light navbar-expand-md py-3" style="background: #82d6bd;height: 120px;">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center"></a>
            <a href="../index.html" style="width: 180px;height: 103.19px;">
                <img data-bss-hover-animate="pulse" src="../img/Logo-removebg.png" style="width: 100%;">
            </a>
            <button data-bs-toggle="collapse" class="navbar-toggler" data-bs-target="#navcol-2">
                <span class="visually-hidden">Toggle navigation</span>
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navcol-2" style="font-weight: bold;height: 100px;">
                <ul class="navbar-nav ms-auto" id="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" data-bss-hover-animate="pulse" href="../shop/shopIndex(Vue).html"
                           style="border-width: 20px;margin-top: 10px;">
                            <img src="../img/gamepad-solid.svg">商城中心
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bss-hover-animate="pulse" href="../sh_shop/sh_MainView.html"
                           style="border-width: 20px;margin-top: 10px;color: var(--bs-dark);">
                            <img src="../img/dice-solid.svg">二手商城
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link align-items-xl-center" data-bss-hover-animate="pulse"
                           style="border-width: 20px;margin-top: 11px;color: var(--bs-dark);"
                           href="../acticle/article_main.html">
                            <img class="d-flex mx-auto" src="../img/newspaper-regular.svg" style="height: 50px;">論壇社群
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bss-hover-animate="pulse" href="../activity/act_finder.html"
                           style="border-width: 20px;margin-top: 10px;color: var(--bs-dark);">
                            <img src="../img/champagne-glasses-solid.svg">活動專區
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" data-bss-hover-animate="pulse" href="../member/member_home.html"
                           style="margin-top: 10px;">
                            <img class="d-flex mx-auto align-items-xl-center" src="../img/user-solid.svg"
                                 style="height: 50px;">會員中心
                        </a>
                    </li>
                    <li class="nav-item login">
                        <a class="nav-link active" data-bss-hover-animate="pulse" href="../member_login.html"
                           style="margin-top: 10px;">
                            <img class="d-flex mx-auto align-items-xl-center" src="../img/user-regular.svg"
                                 style="height: 50px;">會員登入</a>
                    </li>
                </ul>
                <footer id="footerpad-1"></footer>
            </div>
        </div>
    </nav>
</header>

    <div class="main-content" style="height: 800px;">
        <!-- main的區塊 -->
            <div class="container">
                <div class="row">
                    <div class="col-12@sm">
                        <h1>活動舉辦區</h1>
                        <h2>C8763</h2>

                        <ul class="horizontal-menu">
                            <div class="btnI1">

                                <!-- 貼上圖示的程式碼 -->
                                <i class="fas fa-search"></i>
                                <!-- 將value的「搜尋」兩個文字拿掉 -->
                                <input type="button" value="" class="ctrlbutton">
                            </div>
                            <div class="btnI2">
                                <i class="fas fa-clipboard-list" style="color: ctrlbutton"></i>
                                <input type="button" value="" class="ctrlbutton">
                            </div>
                            <li><a href="#"><i class="icon-bookmark"></i></a></li>
                            <li><a href="#">活動列表 <i class="icon-location-arrow"></i></a></li>
                            <li><a href="#">活動參與清單<i class="icon-gear"></i></a></li>
                            <li><a href="#">報名狀態<i class="icon-credit-card"></i></a></li>
                            <li><a href="#">活動檢舉<i class="icon-group"></i></a></li>
                        </ul>

                    </div>
                </div>
            </div>

            <div class="container" id="mainTable">
                <div class="row">
                    <div class="col-4@sm col-3@md">
                        <div class="filters-group">
                            <label for="filters-search-input" class="filter-label">Search</label>
                            <input class="textfield filter__search js-shuffle-search" type="search"
                                id="filters-search-input" />
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12@sm filters-group-wrap">
                        <div class="btn-group filter-options">
                            <button class="btn btn--primary" onclick="toggleTags('sponsor')">主辦人</button>
                            <div id="dropdown-sponsor" class="dropdown-content"></div>

                        </div>


                        <fieldset class="filters-group">
                            <div class="btn-group sort-options">
                                <button class="btn btn--primary" onclick="toggleTags('activity')"
                                    rel="activity">活動</button>
                                <div id="dropdown-activity" class="dropdown-content"></div>
                            </div>
                        </fieldset>
                    </div>
                </div>
            </div>

            <div class="container">
                <div id="grid" class="row my-shuffle-container">

                </div>
            </div>

            <nav aria-label="Page navigation example">
                <ul class="pagination">
                    <li class="page-item">
                        <a class="page-link" href="#" aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>
                    <li class="page-item"><a class="page-link" href="act_finder.html">1</a></li>
                    <li class="page-item"><a class="page-link" href="act_finder2.html">2</a></li>
                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                    <li class="page-item">
                        <a class="page-link" href="#" aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                </ul>
            </nav>
            <div class="sticky-top">
                <footer id="footerpad">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-6 col-lg-8 mx-auto">
                                <ul class="list-inline text-center">
                                    <li class="list-inline-item">
                                        <a href="#">
                                            <span class="fa-stack fa-lg">
                                                <i class="fa fa-circle fa-stack-2x"></i>
                                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                                            </span>
                                        </a>
                                    </li>
                                    <li class="list-inline-item">
                                        <a href="#">
                                            <span class="fa-stack fa-lg">
                                                <i class="fa fa-circle fa-stack-2x"></i>
                                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                            </span>
                                        </a>
                                    </li>
                                    <li class="list-inline-item">
                                        <a href="#">
                                            <span class="fa-stack fa-lg">
                                                <i class="fa fa-circle fa-stack-2x"></i>
                                                <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                                            </span>
                                        </a>
                                    </li>
                                    <li class="list-inline-item"><a href="#"></a>
                                    </li>
                                </ul>
                                <p class="copyright text-muted text-center">Copyright © NBP.gg 2023 | Web Design by
                                    Designer
                                </p>
                            </div>
                        </div>
                    </div>
                </footer>
            </div>
    </div>


</body>



<script src="../jquery/jquery-1.9.1.min.js"></script>

<!-- <script src="./bootstrap/js/bootstrap.min.js"></script> -->
<script src="../js/bs-init.js"></script>
<script src="../js/Profile-Edit-Form.js"></script>
<script src="../js/member_logout.js"></script>
<script>
    function redirectToLink(url) {
        window.location.href = url;

    }
    const sponsorTagsElements = document.querySelectorAll('.Sponsor');
    const activityTagsElements = document.querySelectorAll('a[rel="activity"]');
    let sponsorDropdownVisible = false;
    let activityDropdownVisible = false;

    const activityLinks = Array.from(activityTagsElements).map(element => element.href);

    function toggleTags(group) {
        const dropdown = document.getElementById(`dropdown-${group}`);
        let dropdownVisible;

        if (group === 'sponsor') {
            dropdownVisible = sponsorDropdownVisible;
        } else if (group === 'activity') {
            dropdownVisible = activityDropdownVisible;
        }

        if (!dropdownVisible) {
            dropdown.innerHTML = '';

            if (group === 'sponsor') {
                sponsorTagsElements.forEach((element, index) => {
                    const tag = document.createElement('p');
                    const link = document.createElement('a');
                    link.href = activityLinks[index] || '#'; // 使用索引值來對應活動超連結位置
                    link.target = '_blank';
                    link.rel = 'activity';
                    link.textContent = element.textContent;
                    tag.appendChild(link);
                    dropdown.appendChild(tag);
                });
                sponsorDropdownVisible = true;
            } else if (group === 'activity') {
                activityTagsElements.forEach((element, index) => {
                    const tag = document.createElement('p');
                    const link = document.createElement('a');
                    link.href = element.href;
                    link.target = '_blank';
                    link.rel = 'activity';
                    link.textContent = element.textContent;
                    tag.appendChild(link);
                    dropdown.appendChild(tag);
                });
                activityDropdownVisible = true;
            }

            dropdown.style.display = 'block';
        } else {
            dropdown.style.display = 'none';
            if (group === 'sponsor') {
                sponsorDropdownVisible = false;
            } else if (group === 'activity') {
                activityDropdownVisible = false;
            }
        }
    }

    // 初始化活動下拉菜單
    if (activityTagsElements.length > 0 && !activityDropdownVisible) {
        const dropdown = document.getElementById('dropdown-activity');
        dropdown.innerHTML = '';

        activityTagsElements.forEach((element, index) => {
            const tag = document.createElement('p');
            const link = document.createElement('a');
            link.href = element.href;
            link.target = '_blank';
            link.rel = 'activity';
            link.textContent = element.textContent;
            tag.appendChild(link);
            dropdown.appendChild(tag);
        });

        activityDropdownVisible = true;
    }

    let acts;
    function getActs() {
        $.ajax({
            url: 'http://localhost:8080/gg4nbp/act',
            type: 'GET',
            success: function (response) {

                 acts=response;
                for(let i=12;i<50;i++){
                    let act=acts[i];
                    let imgPath = decodeURIComponent(act.actImage);
                    let childContent = `
                        <figure class="col-3@xs col-4@sm col-3@md picture-item"  data-date-created="${act.actTime}" data-title="${act.actName}" data-id="${act.id}">
                        <div class="picture-item__inner" onclick="redirectToLink('http://localhost:8080/gg4nbp/activity/act_apply.html?no='+'${act.id}')">
                        <div class="aspect aspect--25x9">
                            <div class="aspect__inner">
                                <img src="${imgPath}" alt="${act.actTime}" />
                            </div>
                        </div>
                        <div class="picture-item__details">
                            <figcaption class="picture-item__title">
                                <a href='http://localhost:8080/gg4nbp/activity/act_apply.html?no=12'" target="_blank" rel="activity">${act.actName}</a>
                            </figcaption>
                            <p class="Location">${act.actLocation}</p>
                        </div>
                        </div>
                        </figure>`;
                    $("#grid").append(childContent);
        }
                //acts.for ((act)=>{

//                     let childContent = `
// <figure class="col-3@xs col-4@sm col-3@md picture-item"  data-date-created="${act.actTime}" data-title="${act.actName}" data-id="${act.id}">
// <div class="picture-item__inner" onclick="redirectToLink('${act.actLink}')">
// <div class="aspect aspect--25x9">
//     <div class="aspect__inner">
//         <img src="${act.actImage}" alt="${act.actTime}" />
//     </div>
// </div>
// <div class="picture-item__details">
//     <figcaption class="picture-item__title">
//         <a href="${act.actLink}" target="_blank" rel="activity">${act.actName}</a>
//     </figcaption>
//     <p class="Location">${act.actLocation}</p>
// </div>
// </div>
// </figure>`;
//
//                     $("#grid").append(childContent);
//                 });
            },
            error: function (xhr, status, error) {
                console.log(`Error: ${error}`);
            }
         });
    }
    // 调用函数来获取所有活动数据并显示在页面上
    getActs();

    $(window).on("load", function () {
        $.ajax({
            url: "memberGetPictureServlet",
            method: "POST",
            dataType: "json",
            success: function (response) {
                let member = response;
                let isPass = member.successful;
                if (isPass) {
                    $("li.login").remove();

                    const li = document.createElement('li');
                    li.setAttribute('class', 'nav-item logout');
                    const a = document.createElement("a");
                    a.setAttribute('class', "nav-link fs-6 text-center");
                    a.setAttribute('data-bss-hover-animate', 'pulse');
                    a.setAttribute('id', 'sign_out');
                    a.setAttribute('style', 'margin-top: 0px;color: var(--bs-dark);width: 80px;height: 100px;');
                    a.innerHTML = `
                    <div id="member_pic-1" class="avatar-bg center"style="width: 60px;height: 60px;margin-left: 0px;"></div>登出
                    `;
                    li.append(a);
                    $('ul#navbar-nav').append(li);

                    if(member.headshot){
                        $("div#member_pic-1").css("background-image", `url(${member.headshot})`);
                    } else {
                        $("div#member_pic-1").css("background-image", `url(https://www.gravatar.com/avatar/1234566?size=200&d=mm)`);
                    }
                }
            }
        })


        $("ul").on("click",'li.logout', function (){
            $.ajax({
                url: "memberLogoutServlet",
                method: "POST",
                dataType: "json",
                success:function(){
                    sessionStorage.clear();
                    window.location.href="../index.html";
                }
            })
        })
    })


</script>


</html>